== Agent Configuration for Mirror Registry

.assisted-installer-mirror-config.yaml
----
apiVersion: v1
kind: ConfigMap
metadata:
  name: assisted-installer-mirror-config
  namespace: multicluster-engine
  labels:
    app: assisted-service
data:
  ca-bundle.crt: |
    -----BEGIN CERTIFICATE-----
    -----END CERTIFICATE-----
  registries.conf: |
    unqualified-search-registries = ["registry.access.redhat.com", "docker.io"]
    short-name-mode = ""

    [[registry]]
    prefix = ""
    location = "docker.io"

    [[registry.mirror]]
      location = "quay.pietersmalan.com/dockeriocache"
      pull-from-mirror = "digest-only"

    [[registry.mirror]]
      location = "quay.pietersmalan.com/dockeriocache"
      pull-from-mirror = "tag-only"

    [[registry]]
      prefix = ""
      location = "quay.io"

    [[registry.mirror]]
      location = "quay.pietersmalan.com/cachequayio"
      pull-from-mirror = "digest-only"

    [[registry.mirror]]
      location = "quay.pietersmalan.com/cachequayio"
      pull-from-mirror = "tag-only"

    [[registry]]
      prefix = ""
      location = "registry.redhat.io"

    [[registry.mirror]]
      location = "quay.pietersmalan.com/registryredhatiocache"
      pull-from-mirror = "digest-only"

    [[registry.mirror]]
      location = "quay.pietersmalan.com/registryredhatiocache"
      pull-from-mirror = "tag-only"
----

.Add mirror registry config refence in AgentServiceConfig
----
apiVersion: agent-install.openshift.io/v1beta1
kind: AgentServiceConfig
metadata:
  namespace: multicluster-engine
  name: agent
...
spec:
....
  mirrorRegistryRef:
    name: 'assisted-installer-mirror-config'
....
----
